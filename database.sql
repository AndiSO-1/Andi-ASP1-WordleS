USE master
GO
SET NOCOUNT ON

DECLARE @kill varchar(8000) = '';  
SELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'  
FROM sys.dm_exec_sessions
WHERE database_id  = db_id('WordleS')

EXEC(@kill);

-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------
-- Suppression de la base de donn�es
-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------

IF EXISTS(select * from sys.databases where name='WordleS')
DROP DATABASE WordleS
GO

-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------
-- Création de la base de donn�es
-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------

--CREATE DATABASE .....

CREATE DATABASE WordleS
GO

-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------
-- Création des tables
-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------


USE WordleS
GO

CREATE TABLE Users (
	id int IDENTITY(1,1) PRIMARY KEY,
	pseudo varchar(50),
	[login] varchar(50),
	[password] varchar(MAX),
	fkRole int);

CREATE TABLE Roles (
	id int IDENTITY(1,1) PRIMARY KEY,
	[name] varchar(50),
	slug varchar(25));


-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------
-- Constraints
-------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------

ALTER TABLE Users
ADD CONSTRAINT UserHasRole
FOREIGN KEY (fkRole) REFERENCES Roles(id);
GO